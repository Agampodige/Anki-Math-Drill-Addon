<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Math Drill Test</title>
</head>
<body>
    <h1>Math Drill Test</h1>
    
    <!-- Test Elements -->
    <div id="sessionCount">0</div>
    <div id="todayCount">0</div>
    <div id="lifetimeCount">0</div>
    <div id="statsDetail">Start answering to see stats</div>
    
    <select id="modeBox">
        <option value="Free Play">Free Play</option>
        <option value="Drill (20 Qs)">Drill (20 Qs)</option>
    </select>
    
    <select id="operationBox">
        <option value="Addition">Addition</option>
        <option value="Subtraction">Subtraction</option>
    </select>
    
    <select id="digitsBox">
        <option value="1 digit">1 digit</option>
        <option value="2 digits">2 digits</option>
    </select>
    
    <input type="text" id="answerInput" placeholder="?">
    <div id="feedback">Press Enter to Start</div>
    
    <div id="modalOverlay" style="display: none;">
        <div id="resultModal" style="display: none;">
            <button id="closeResultBtn">Close</button>
            <button id="retakeBtn">Retake</button>
        </div>
    </div>
    
    <div id="achievementToast" style="display: none;">
        <div id="toastMessage"></div>
    </div>
    
    <script>
        // Mock Python bridge for testing
        window.pythonBridge = {
            send: function(action, data, callbackId) {
                console.log('Mock bridge send:', action, data, callbackId);
                
                // Mock stats response
                if (action === 'get_stats') {
                    setTimeout(() => {
                        const mockStats = {
                            session: 5,
                            today: 12,
                            lifetime: 156,
                            accuracy: 85.5,
                            avgSpeed: 2.3,
                            totalTime: 27.6
                        };
                        
                        // Execute callback if provided
                        if (callbackId && window.pythonBridge.callbacks && window.pythonBridge.callbacks[callbackId]) {
                            window.pythonBridge.callbacks[callbackId](mockStats);
                        }
                    }, 100);
                }
            },
            callbacks: {}
        };
        
        // Load the actual script
        const script = document.createElement('script');
        script.src = '../web/script.js';
        script.onload = function() {
            console.log('Script loaded successfully');
            
            // Test initialization
            if (window.mathDrill) {
                console.log('MathDrill initialized successfully');
                console.log('Elements found:', {
                    sessionCount: !!window.mathDrill.sessionCount,
                    todayCount: !!window.mathDrill.todayCount,
                    lifetimeCount: !!window.mathDrill.lifetimeCount,
                    modeBox: !!window.mathDrill.modeBox,
                    operationBox: !!window.mathDrill.operationBox,
                    digitsBox: !!window.mathDrill.digitsBox,
                    answerInput: !!window.mathDrill.answerInput
                });
            } else {
                console.error('MathDrill not initialized');
            }
        };
        script.onerror = function() {
            console.error('Failed to load script');
        };
        document.head.appendChild(script);
    </script>
</body>
</html>
