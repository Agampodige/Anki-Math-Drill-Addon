<!DOCTYPE html>
<html lang="en">

<head>
    <link href="style.css" rel="stylesheet">
    <link href="practice_mode.css" rel="stylesheet">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title data-i18n="practice.title">Practice Mode</title>
</head>

<body>
    <main>
        <div class="page-container active">
            <div class="practice-mode-container">
                <!-- Navigation Bar -->
                <div class="practice-nav-bar">
                    <button id="backBtn" class="practice-back-button">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2">
                            <path d="M19 12H5M12 19l-7-7 7-7" />
                        </svg>
                    </button>
                    <h1 class="practice-title" data-i18n="practice.title">Free Practice</h1>
                    <div class="practice-nav-actions">
                        <button id="soundToggle" class="icon-button" title="Toggle Sound Effects">
                            <svg id="soundIcon" width="20" height="20" viewBox="0 0 24 24" fill="none"
                                stroke="currentColor" stroke-width="2">
                                <path d="M11 5L6 9H2v6h4l5 4V5z" />
                                <path id="soundWaves" d="M15.54 8.46a5 5 0 0 1 0 7.07M19.07 4.93a10 10 0 0 1 0 14.14" />
                            </svg>
                        </button>
                        <button id="helpBtn" class="icon-button" title="Keyboard Shortcuts">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                stroke-width="2">
                                <circle cx="12" cy="12" r="10" />
                                <path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3" />
                                <line x1="12" y1="17" x2="12.01" y2="17" />
                            </svg>
                        </button>
                    </div>
                </div>

                <!-- Progress Bar -->
                <div class="practice-progress-container" id="progressContainer" style="display: none;">
                    <div class="practice-progress-bar" id="progressBar"></div>
                </div>

                <!-- Settings Panel -->
                <div class="practice-settings" id="settingsPanel">
                    <div class="settings-row">
                        <div class="setting-item">
                            <label for="operationSelect" data-i18n="practice.operation">Operation</label>
                            <select id="operationSelect">
                                <option value="addition" data-i18n="practice.addition">Addition (X + Y)</option>
                                <option value="subtraction" data-i18n="practice.subtraction">Subtraction (X - Y)</option>
                                <option value="multiplication" data-i18n="practice.multiplication">Multiplication (X × Y)</option>
                                <option value="division" data-i18n="practice.division">Division (X ÷ Y)</option>
                                <option value="complex" data-i18n="practice.complex">Complex (X + Y × Z)</option>
                            </select>
                        </div>
                        <div class="setting-item">
                            <label for="digitsSelect" data-i18n="practice.difficulty">Difficulty</label>
                            <select id="digitsSelect">
                                <option value="1" data-i18n="practice.easy_1_digit">Easy - 1 Digit</option>
                                <option value="2" selected data-i18n="practice.medium_2_digits">Medium - 2 Digits</option>
                                <option value="3" data-i18n="practice.hard_3_digits">Hard - 3 Digits</option>
                                <option value="4" data-i18n="practice.extreme_4_digits">Extreme - 4 Digits</option>
                            </select>
                        </div>
                        <div class="setting-item">
                            <label for="timeSelect" data-i18n="practice.time_limit">Time Limit</label>
                            <select id="timeSelect">
                                <option value="infinity" data-i18n="practice.infinity">∞ Infinity</option>
                                <option value="30">30 seconds</option>
                                <option value="60">1 minute</option>
                                <option value="120">2 minutes</option>
                                <option value="300">5 minutes</option>
                                <option value="600">10 minutes</option>
                                <option value="900">15 minutes</option>
                                <option value="1800">30 minutes</option>
                            </select>
                        </div>
                        <button id="startBtn" class="practice-start-button" data-i18n="practice.start">Start Practice</button>
                    </div>
                </div>

                <!-- Question Area (Hidden until started) -->
                <div class="practice-content" id="practiceArea" style="display: none;">
                    <!-- New Dashboard Header -->
                    <div class="practice-header">
                        <div class="stat-card">
                            <span class="card-label" data-i18n="practice.question">Question</span>
                            <span class="card-value" id="questionNumber">1</span>
                        </div>
                        <div class="stat-card highlight">
                            <span class="card-label" data-i18n="practice.correct">Correct</span>
                            <span class="card-value" id="correctCount">0</span>
                        </div>
                        <div class="stat-card highlight-alt">
                            <span class="card-label" data-i18n="analytics.current_streak">Streak</span>
                            <span class="card-value" id="streakCount">0</span>
                        </div>
                        <div class="stat-card timer-card">
                            <span class="card-label" data-i18n="practice.time">Time</span>
                            <span class="card-value" id="timerDisplay">0.0s</span>
                        </div>
                        <div class="stat-card time-limit-card" id="timeLimitCard" style="display: none;">
                            <span class="card-label" data-i18n="practice.time_remaining">Time Left</span>
                            <span class="card-value" id="timeRemainingDisplay">∞</span>
                        </div>
                    </div>

                    <!-- Main Practice Core -->
                    <div class="practice-main-view">
                        <!-- Question Card -->
                        <div class="question-card" id="questionCard">
                            <div class="question-box">
                                <h2 id="questionText" data-i18n="practice.ready">Ready?</h2>
                            </div>

                            <!-- Answer Input -->
                            <div class="input-area" id="typingInputArea">
                                <input type="number" id="answerInput" data-i18n-placeholder="practice.answer_placeholder" placeholder="?" disabled>
                                <button id="submitBtn" class="submit-button" disabled>
                                    <span data-i18n="practice.answer">Submit</span>
                                </button>
                            </div>

                            <!-- MCQ Options (Hidden by default) -->
                            <div class="mcq-area" id="mcqInputArea" style="display: none;">
                                <div class="mcq-options" id="mcqOptions">
                                    <button class="mcq-option" data-option="A" disabled>
                                        <span class="option-label" data-i18n="practice.option_a">A</span>
                                        <span class="option-value"></span>
                                    </button>
                                    <button class="mcq-option" data-option="B" disabled>
                                        <span class="option-label" data-i18n="practice.option_b">B</span>
                                        <span class="option-value"></span>
                                    </button>
                                    <button class="mcq-option" data-option="C" disabled>
                                        <span class="option-label" data-i18n="practice.option_c">C</span>
                                        <span class="option-value"></span>
                                    </button>
                                    <button class="mcq-option" data-option="D" disabled>
                                        <span class="option-label" data-i18n="practice.option_d">D</span>
                                        <span class="option-value"></span>
                                    </button>
                                </div>
                            </div>
                        </div>

                        <!-- Inline Feedback Area -->
                        <div class="feedback-area" id="feedbackArea" style="display: none;">
                            <div class="feedback-header">
                                <div class="feedback-icon" id="feedbackIcon"></div>
                                <div class="feedback-title" id="feedbackTitle"></div>
                            </div>
                            <div class="feedback-details">
                                <div class="feedback-row">
                                    <span data-i18n="practice.your_answer">Your Answer:</span>
                                    <strong id="userAnswer"></strong>
                                </div>
                                <div class="feedback-row">
                                    <span data-i18n="practice.correct_answer">Correct:</span>
                                    <strong id="correctAnswer"></strong>
                                </div>
                                <div class="feedback-row">
                                    <span data-i18n="practice.speed">Speed:</span>
                                    <strong id="timeTaken"></strong>
                                </div>
                            </div>
                            <button id="nextBtn" class="continue-button" data-i18n="practice.continue">Continue</button>
                        </div>
                    </div>

                    <!-- Live Stats Summary -->
                    <div class="stats-summary">
                        <div class="summary-stat">
                            <span class="summary-label" data-i18n="analytics.total_problems">Total</span>
                            <span class="summary-value" id="totalQuestions">0</span>
                        </div>
                        <div class="summary-stat">
                            <span class="summary-label" data-i18n="practice.accuracy">Accuracy</span>
                            <span class="summary-value" id="accuracy">0%</span>
                        </div>
                        <div class="summary-stat">
                            <span class="summary-label" data-i18n="analytics.avg_time">Avg Time</span>
                            <span class="summary-value" id="avgTime">0.0s</span>
                        </div>
                    </div>
                </div>

                <!-- Practice Controls -->
                <div class="practice-controls" id="practiceControls" style="display: none;">
                    <button id="pauseBtn" class="pause-button">⏸ Pause</button>
                    <button id="stopBtn" class="stop-button">Stop Practice</button>
                </div>
            </div>
        </div>
    </main>

    <!-- Keyboard Shortcuts Help Modal -->
    <div id="helpModal" class="modal-overlay" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Keyboard Shortcuts</h2>
                <button id="closeHelp" class="close-button">×</button>
            </div>
            <div class="modal-body">
                <div class="shortcut-item">
                    <kbd>Enter</kbd>
                    <span>Submit answer (typing mode)</span>
                </div>
                <div class="shortcut-item">
                    <kbd>1, 2, 3, 4</kbd>
                    <span>Select MCQ option</span>
                </div>
                <div class="shortcut-item">
                    <kbd>a, s, d, f</kbd>
                    <span>Select MCQ option</span>
                </div>
                <div class="shortcut-item">
                    <kbd>Space</kbd>
                    <span>Next question (after feedback)</span>
                </div>
                <div class="shortcut-item">
                    <kbd>Esc</kbd>
                    <span>Stop practice</span>
                </div>
                <div class="shortcut-item">
                    <kbd>P</kbd>
                    <span>Pause/Resume</span>
                </div>
                <div class="shortcut-item">
                    <kbd>?</kbd>
                    <span>Show this help</span>
                </div>
            </div>
        </div>
    </div>

    <!-- Pause Overlay -->
    <div id="pauseOverlay" class="pause-overlay" style="display: none;">
        <div class="pause-content">
            <h2>⏸ Paused</h2>
            <p>Take a break! Press Resume when you're ready.</p>
            <button id="resumeBtn" class="resume-button">Resume Practice</button>
        </div>
    </div>

    <!-- Celebration Overlay -->
    <div id="celebrationOverlay" class="celebration-overlay" style="display: none;">
        <div class="celebration-content">
            <div class="confetti-container" id="confettiContainer"></div>
            <div class="celebration-message" id="celebrationMessage"></div>
        </div>
    </div>

    <script src="qrc:///qtwebchannel/qwebchannel.js"></script>
    <script src="i18n.js"></script>
    <script src="context_menu.js"></script>
    <script src="session_manager.js"></script>
    <script src="app.js"></script>
    <script src="practice_sounds.js"></script>
    <script src="practice_mode.js"></script>
</body>

</html>